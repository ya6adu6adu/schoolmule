<?php	class translate {	 		protected $msData, $accessToken;	 		public function __construct($msData) {//в массиве msdata хранятся client_id и client_secret			$this->msData = $msData;			$this->initAccessToken();		}	 		protected function initAccessToken() {//получаем accessToken			$curl = curl_init("https://datamarket.accesscontrol.windows.net/v2/OAuth2-13/");			curl_setopt_array($curl, array(				CURLOPT_POST => true, //формируем POST-запрос для получения токена				CURLOPT_POSTFIELDS => http_build_query(array(					'client_id' => $this->msData['clientid'],					'client_secret' => $this->msData['clientsecret'],					'scope' => 'http://api.microsofttranslator.com',//это значение указано в документации					'grant_type' => "client_credentials"//это значение указано в документации				)),				CURLOPT_SSL_VERIFYPEER => false,				CURLOPT_RETURNTRANSFER => true,			));			$response = curl_exec($curl);			$err = curl_errno($curl);			if ($err)				throw new Exception("$err curl err" );			$r_obj = json_decode($response);			if (!isset($r_obj))				throw new Exception("$response illegal response: ");			$this->accessToken = $r_obj->access_token;		}    	 		public function translate($text, $lang_to, $lang_from) {			$query_arr = array(				'appId' => 'Bearer '.$this->accessToken,				'text' => $text,				'from' => $lang_from,				'to' => $lang_to,				'contentType' => 'text/plain'			);			$query = http_build_query($query_arr);			$url = 'http://api.microsofttranslator.com/V2/Http.svc/Translate?'.$query;			$curl = curl_init($url);			curl_setopt($curl, CURLOPT_RETURNTRANSFER, 1);						$response = curl_exec($curl);			$err = curl_errno($curl);			if ($err)				throw new Exception("$err curl err" );			$xml = new SimpleXMLElement($response); //получаем строку перевода из xml-ответа			return  (string) $xml;					}	}?>